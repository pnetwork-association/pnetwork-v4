# Attestator tool

You may use this tool in order to generate PAM compatible proof in order to test them
easily in the forge/hardhat suites.

For instace, you can enable the commented logging instructions the `Helper.sol` in the `_getOperationFromRecordedLogs` function body

```js
console.log('////////////////////////////////')
console.log(entries[last].emitter) // address
console.log(vm.toString(entries[last].data)) // data
console.log(vm.toString(entries[last].topics[0])) // topic0
console.log(vm.toString(entries[last].topics[1])) // topic1
```

Then run the forge tests with the -vvv flags:

```
forge test --mt Pegout -vvv
```

You'll see the event above gets printed on stdout. You can use this output
as an input for the `attestator.js` tool in the following way

```bash
 ./attestator.js metadata -c 31338 0x63f58053c9499E1104a6f6c6d2581d6D83067EEB 0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000051a240271ab8ab9f9a21c82d9a85396b704e164d0000000000000000000000000000000000000000000000000000000000007a6a00000000000000000000000000000000000000000000000000000000000013880000000000000000000000006813eb9362372eef6200f3b1dbc3f819671cba6900000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000002a307836383133456239333632333732454546363230306633623164624333663831393637316342413639000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 0xb7f44fc1e9a3dc73e2b3edcde2016158d1d9449c356f751c6d77d4a20f2abd9b 0x0000000000000000000000000000000000000000000000000000000000000000
```

The output would be something like:

```
context: 0x01010000000000000000000000000000000000000000000000000000000000007a6a
preimage: 0x01010000000000000000000000000000000000000000000000000000000000007a6aa880cb2ab67ec9140db0f6de238b34d4108f6fab99315772ee987ef9002e0e6311365bbee18058f12c27236e891a66999c4325879865303f785854e9169c257a00000000000000000000000063f58053c9499e1104a6f6c6d2581d6d83067eeb9a940ae878863b0e8407b67062b1be16f91b806c05bd5173b65a5c0aa227c7e40000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000051a240271ab8ab9f9a21c82d9a85396b704e164d0000000000000000000000000000000000000000000000000000000000007a6a00000000000000000000000000000000000000000000000000000000000013880000000000000000000000006813eb9362372eef6200f3b1dbc3f819671cba6900000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000140000000000000000000000000000000000000000000000000000000000000002a307836383133456239333632333732454546363230306633623164624333663831393637316342413639000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eventid: 0x91929c18489c19b012164b634404cc4aa6871189b6320111d1a9b58cc857bf90
signature: 0xae80efa7e63b3919fdf2e177912b0d20fd27b733c2734b874526017f1eeba4dd2bf512e9c6f85b724d09e01536bc89205febd9f792a5930f80d7214528fb7ca61c
```

`preimage` and `signature` are the metadata fields the PAM will verify in the authorization function, the rest is there just for debugging purposes.

**Note:** be sure to set the correct `--chain-id` when generating proofs, otherwise the authorization will not be granted if the chain id does not match.
